
<!DOCTYPE html>
<html>
<head>
<title>100 Nums - iOS - Android - Windows Phone</title>
<link rel="shortcut icon" href="favicon.ico" />
<style>
*{
 	//padding: 30px;
 	margin: auto;
}
body{
	background-color: #e6e6dc;
}
#contain {
	width: 330px;
}
#timeRemainBar {
	width: 330px;
}
#game_canvas {
	background-color: #BBADA0;
	margin: auto;
}
.link{
	float: right;
	height: 80px;
	line-height: 80px;
}
</style>

<script>

		//sound
		var sfx_game_lost = new Audio('sound/sfx_game_lost.mp3');
		var sfx_game_win = new Audio('sound/sfx_game_win.mp3');
		var sfx_hit_right = new Audio('sound/sfx_hit_right.wav');
		var sfx_menu_select = new Audio('sound/sfx_menu_select.m4a');
		
		var fontSize = 50;
		var space = 5;
		var colors = [ "red", "orange",	"yellow", "green", "blue", "indigo", "violet" ] ;
		var canvas;
		var timeRemainBar;
		var context;
		var  width = 6;
		var  height = 7;
		var TIME_WAIT = 8;
		
		var nums; // Store all Number to draw
		var numPoints; // Store number and position
		var remainTime;
		var currentNum;
		var isPause;
		var iLoopColor;
		setTimeout(setTime, 1000);
		function init(){
			canvas = document.getElementById("game_canvas");
			timeRemainBar = document.getElementById("timeRemainBar");
			canvas.addEventListener("mouseup", mouseDown, false);
			context = canvas.getContext("2d");
			context.font = "bold 50px Arial";
			context.clearRect(0, 0, canvas.width, canvas.height);
			//context.fillStyle = "rgba(187, 173, 160, 1.0)";
			//context.fillRect(0, 0, canvas.width, canvas.height);
			nums = [];
			console.log("nums.length: " + nums.length);
			remainTime = TIME_WAIT; // seconds
			currentNum = 0;
			isPause = false;
			for(var i = 0; i < width*height; i++)
				if(i < 10)
					nums[i] = "0" + i.toString();
				else
					nums[i] = i.toString();
			numPoints = [];
			console.log("numPoints.length: " + numPoints.length);
			var t = 0;
			for (var i = 0; i < width; i++)
				for (var j = 0; j < height; j++){
					var k = Math.floor(Math.random()*7);
					context.fillStyle = colors[k];
					var index = Math.floor(Math.random()*nums.length);
					var num = nums[index];
					context.fillText(num, i*(fontSize+space), (j+1)*(fontSize+space));
					numPoints.push({ n: num, color: k, x: i*(fontSize+space), y: (j+1)*(fontSize+space) });
					//console.log("k: "+ k + " num: " + num + " X: " + (i*(fontSize+space)).toString() +  " Y: " + ((j+1)*(fontSize+space)).toString());
					nums.splice(index, 1);
					//console.log("nums.length: " + nums.length);
					t++;
				}
	// 	  		for(var i = 0; i < numPoints.length; i++){
	//   				console.log("num: " + numPoints[i].n + " Color: " +  numPoints[i].color + " X: " + numPoints[i].x + " y: " + numPoints[i].y);
	//   			}
			}
		function mouseDown(event){
			//alert("x: " + event.pageX + " y: " + event.pageY);
			var mousePos = getMousePos(canvas, event);
			var xxx = 38;
			for(var i = 0; i < numPoints.length; i++)
				if(mousePos.x >= numPoints[i].x && mousePos.x <= numPoints[i].x + fontSize
				&& mousePos.y <= numPoints[i].y && mousePos.y >= numPoints[i].y - xxx){
					//document.getElementById("debug").innerHTML = "x: " + mousePos.x + " y: " + mousePos.y;
					if(parseInt(numPoints[i].n) == currentNum){
						sfx_hit_right.play();
						currentNum++;
						remainTime = TIME_WAIT;
						iLoopColor = numPoints[i].color+1;
						setTimeout(loopColor, 100, numPoints[i], numPoints[i].color);
						if(currentNum == width*height) gameWin();
					} else{
						//document.getElementById("debug").innerHTML = "Game Over"
						gameLost();
					}
					//document.getElementById("debug").innerHTML = parseInt(numPoints[i].n) + "x: " + mousePos.x + " y: " + mousePos.y;
					//context.fillStyle = "black";
					//context.fillText(numPoints[i].n, numPoints[i].x, numPoints[i].y);
					break;
				}
		}
		
		
		function getMousePos(canvas, evt) {
			var rect = canvas.getBoundingClientRect();
			return {
				x : evt.clientX - rect.left,
				y : evt.clientY - rect.top
			};
		}
		function setTime(){
			if(isPause) return;
			remainTime--;
			timeRemainBar.value = 100*remainTime/(TIME_WAIT - 1);
			document.getElementById("debug").innerHTML = remainTime;
			if(remainTime == 0){
				gameLost();
			}
			setTimeout(setTime, 1000);
		}
		
		function gameLost(){
			sfx_game_lost.play();
			isPause = true;
			alert("Game Over");
			init();
		}
		
		function gameWin(){
			sfx_game_win.play();
			isPause = true;
			if(confirm("Game Win"))
				init();
		}
		
		function loopColor(numPoint, currentColor){
			if(iLoopColor == 7) iLoopColor = 0;
			context.fillStyle = colors[iLoopColor];
			context.fillText(numPoint.n, numPoint.x, numPoint.y);
			if(iLoopColor == currentColor) return;
			iLoopColor++;
			setTimeout(loopColor, 100, numPoint, currentColor);
		}
	</script>
	
</head>
<body onload="init();">
	<div id="contain" >
		<img border="0" src="image/Title100Nums.png" >
		<label>TRY TO FIND 00, 01, 02 .. YOU ONLY HAVE 7 SECONDS TO FIND A NUMBER</label>
		<progress id="timeRemainBar" value="100" max="100" > </progress>
		<canvas id="game_canvas" width="330" height="405">
		Your browser doesn't support the HTML5<a
			href="https://www.google.com/intl/en/chrome/browser/">Get Chrome Browser</a>
		</canvas>
		<div id="ios">
			<a href="#"><img border="0" src="image/ios_logo.png" ></a>
			<a class="link" href="#">google.com</a>
		</div>
		<div id="google">
			<a href="http://goo.gl/PSza0o"><img border="0" src="image/google_play_logo.png" ></a>
			<a class="link" href="http://goo.gl/PSza0o">goo.gl/PSza0o</a>
		</div>
		<div id="winphone">
			<a href="#"><img border="0" src="image/windowsphone_logo.png" ></a>
			<a class="link" href="#">google.com</a>
		</div>
		<div id="debug">Debug</div>
	</div>
</body>
</html>
